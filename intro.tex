\chapter{Introduction}

The study of homotopy theoretic phenomena in the language of type theory \cite{hottbook} is 
sometimes loosely called `synthetic homotopy theory' \cite{Brunerie16}. 
Homotopy theory in type theory \cite{Awodey12} is only one of the
many aspects of homotopy type theory, which also includes the study of the
set theoretic semantics (models of homotopy type theory and univalence in a
meta-theory of sets or categories \cite{Awodey14,AwodeyWarren,BezemCoquandHuber,KapulkinLeFanuLumsdaine,Shulman15,Voevodsky15}), type theoretic semantics (internal models of homotopy type
theory), and computational semantics \cite{AngiuliHarperWilson}, as well as the study of various questions
in the internal language of homotopy type theory which are not necessarily 
motivated by homotopy theory, or questions related to the development of
formalized libraries of mathematics based on homotopy type theory.
This thesis concerns the development of synthetic homotopy theory.

Homotopy type theory is based on Martin-L\"of's theory of dependent types \cite{MartinLof1984}, which
was developed during the 1970's and 1980's.
The novel additions of homotopy type theory are Voevodsky's univalence axiom \cite{Voevodsky06,Voevodsky10},
and higher inductive types \cite{Lumsdaine11Blog,Shulman11Blog,hottbook}. The univalence axiom characterizes the identity
type on the universe, and establishes the universe as an object classifier \cite{RijkeSpitters}.
Higher inductive types are a generalization of inductive types, in which both
point constructors (generators) and path constructors (relations) may be specified.
A simple class of higher inductive types, which includes most known higher inductive
types, are the homotopy pushouts. When the universe is assumed to be closed
under homotopy pushouts, it is also closed under homotopy coequalizers \cite{hottbook}, 
sequential colimits \cite{hottbook}, and propositional truncation \cite{vanDoorn2016}.
For instance, one way of obtaining the $n$-spheres \cite{Lumsdaine12Blog} using homotopy pushouts is by setting $\sphere{-1}\defeq\emptyt$ and
by inductively defining the $(n+1)$-sphere $\sphere{n+1}$ to be the pushout
of the span $\unit \leftarrow\sphere{n}\rightarrow\unit$. 
Then we can attach $(n+1)$-cells to a type $X$.
Let $f:(\sm{a:A}B(a))\to X$ be a family of attaching maps
for some $\sphere{n}$-bundle $B:A\to\mathrm{BAut}(\sphere{n})$, where $\mathrm{BAut}(\sphere{n})$ is the type $\sm{X:\UU}\brck{\eqv{\sphere{n}}{X}}$ of types merely equivalent to the $n$-sphere. We
attach the $(n+1)$-disks indexed by $A$ to $X$ by taking the homotopy pushout
\begin{equation*}
\begin{tikzcd}
\sm{a:A}B(a) \arrow[r,"f"] \arrow[d,swap,"\pi_1"]  & X \arrow[d,"\inr"] \\
A \arrow[r,swap,"\inl"] & P. \arrow[ul,phantom,very near start,"\ulcorner"]
\end{tikzcd}
\end{equation*}
In this thesis we study dependent type theory with univalent universes that are closed under homotopy pushouts, further developing the program set out in \cite{hottbook} on synthetic homotopy theory. We will assume in this dissertation that every type family is classified by a univalent universe, and that all universes are closed under homotopy pushouts, as well as under the usual type constructors including identity types, $\Pi$- and $\Sigma$-types, and a natural numbers object. The model in cubical sets by Coquand et al. \cite{BezemCoquandHuber} is a constructive model for this setup, although the fact that it is closed under homotopy pushouts is currently unpublished. Furthermore, we will exclusively work with objects that can be described either as (dependent) types, or as their terms. In other words, the objects of our study are all `formalizeable' in the sense that they can be encoded in computer implementations of our setup of dependent type theory. Existing implementations of dependent type theory, supporting univalent universes and homotopy pushouts, with libraries developing synthetic homotopy theory, include the proof assistants Agda \cite{agda}, Coq \cite{Coq,hcoq}, and Lean \cite{vDvRB2017HoTTLean}, and parts of the material in this theses are formalized in each of them. 

One of the most persisting open problems of synthetic homotopy theory is the problem of defining the type of simplicial objects, or even the type of semi-simplicial objects. Related open problems include the specifications of the types of weak $\infty$-categories, and weak $\infty$-groupoids. In all these problems, the task is to find a way of specifying in type theory the infinite coherence data that these objects come equipped with. Because of this problem, we have currently no way of exhibiting the universe of all small types, and functions between them, as a term in the type of weak $\infty$-categories; there is no way of presenting the suspension operation as a functor, beyond specifying its action on objects, on morphisms, and the composition laws for low dimensions; and there is no way of making precise the suspension-loop space adjunction beyond establishing the universal property of the adjunction. In other words, there are many examples of `categories', `functors', `natural transformations', and `adjunction' that we know \emph{ought to be} adjunctions, but we have no way (yet) of establishing them as such in a formalizeable way, i.e.~by exhibiting them as a term of the types of categories, functors, natural transformations, or adjunctions, etcetera. This is an important limitation of synthetic homotopy theory that we currently have to deal with.

As we will see in this dissertation, there are some cases in which we can `bypass' the infinite coherence problem, often involving a way to uniformly generate all higher coherences without having to explicitly specify them. In \cref{chap:giraud} we will propose a definition of $\infty$-groupoid structure on a type, and prove for this definition the effectiveness of the quotienting operation, i.e.~Giraud's axiom. Although our definition doesn't generalize to a definition of simplicial types, this provides a glimmer of hope that a definition of simplicial types might be possible.

Another important limitation of synthetic homotopy theory is that many well-known topological spaces do not have a definition yet in homotopy type theory. We work with homotopy pushouts, so most CW-complexes \emph{ought to be} describable in homotopy type theory. The truth is that finding explicit definitions of the attaching maps is often an enormous hassle, and beyond that, doing so in an entirely homotopy invariant way might involve solving open problems. For example, it is still not known how to define the Grassmannians in homotopy type theory. At the time of writing \cite{hottbook}, it even wasn't known how to define the real and complex projective spaces. We present a definition of $\rprojective{n}$ and $\cprojective{n}$ in \cref{chap:projective}.

\section{Overview per chapter}
In \cref{chap:univalent} we will first establish notation, although we will mostly follow the notation from \cite{hottbook}\footnote{A difference of practice between \cite{hottbook} and this thesis is that \cite{hottbook} doesn't use the label `Proposition' for any results at all, whereas we use propositions for statements that might be of independent interest, but are not our main theorem. In this thesis, the label `Theorem' is reserved for the main results that were originally established in my thesis research, and is therefore used much more sparingly.}. Furthermore, we recall some of the most basic facts of homotopy type theory, and then we will show that the univalence axiom establishes any universe as an object classifier. 

In \cref{chap:descent} we will first recall the most basic properties of homotopy pushouts, and then we will proceed to prove the descent property for pushouts, using the univalence axiom. Note that the coherence problem of type theory plays a role in this chapter: we would much rather have shown that the descent property holds for any homotopy colimit, but this task requires the definition of an internal $\infty$-category. Some solace will be offered in \cref{chap:equifibrant}, where we will prove a descent property for any modality.

In \cref{chap:rcoeq} we will study reflexive graphs and, most importantly, reflexive coequalizers in type theory. We take interest in reflexive graphs, because (type-valued) reflexive relations are a good (and useful) first approximation of $\infty$-equivalence relations, the topic of \cref{chap:giraud}. Moreover, we take inspiration from the fact that the topos of reflexive graphs (over sets) is cohesive over the topos of sets. The left-most adjunction is the reflexive coequalier which is left adjoint to the discrete functor. We will construct the reflexive coequalizer as a pushout, so it exists under our assumptions, and we know in some cases how to compute them into previously known operations. Here we run again into the limitation of homotopy type theory, because we cannot establish the type of reflexive graphs as the type of objects of an $\infty$-category, and neither can we establish the reflexive coequalizer as an $\infty$-functor. However, to state and prove that the reflexive coequalizer satisfies the universal property of the left adjoint of the discrete functor, we only need composition of reflexive graph morphisms, and the action on morphisms of the operation equipping a type with the structure of a discrete graph. The universal property is indeed sufficient for many purposes. We then introduce the notion of fibrations for reflexive graphs, and show that the fibrations are right orthogonal to the same maps as the discrete reflexive graphs: morphisms between representables. It follows that a morphism is a fibration if and only if it is cartesian. Then we proceed to prove the descent property of reflexive coequalizers. We also note that diagrams over reflexive graphs are just left fibrations of reflexive graphs, so we also obtain a descent theorem for diagrams over graphs. Of particular interest is the descent property for sequential colimits. The contents of this chapter are joint work with Bas Spitters.

In \cref{chap:simplicial} we consider `$2$-simplicial types', i.e.~types equipped with families of $1$-cells and of $2$-cells and a simplicial structure on them. Naturally occurring examples of $2$-simplicial types include the $2$-pre-kernel of a map (i.e. the $2$-truncated \v Cech nerve), and any \emph{coherent} H-space can be seen as a $2$-simplicial type with one $0$-cell. We will see how many of the concepts of \cref{chap:rcoeq} generalize to the case of $2$-simplicial types, and moreover we will show that the geometric realization of $2$-simplicial types can be computed as a $2$-pushout. In particular, we will see that the geometric realization of the $2$-pre-kernel of a map $f:A\to X$ is the triple fiberwise join $\join[X]{A}{\join[X]{A}{A}}$, and the geometric realization of a coherent H-space is the cofiber of the Hopf map $\eta_X:\join{X}{X}\to \susp X$. 

In \cref{chap:image} we will show that any function factors as a surjective function followed by an embedding, even though we only assume that the universe is closed under pushouts and the basic type constructors. Of course, it is of essential importance here that the universe contains a natural numbers object. Our construction of the image of a map proceeds by iteratively taking the fiberwise join of a map with itself, so we call it the join construction. It follows from our construction that the image of a map from an essentially small type into a locally small type (notions that are explained in \cref{chap:univalent}), is again essentially small. The join construction can be used to construct the quotient of a type by a $\prop$-valued equivalence relation (i.e.~an equivalence relation in the usual sense), and it can be used to construct the Rezk completion of a pre-category. The construction of set-quotients includes the construction of the set truncation, and the construction of the Rezk completion includes the construction of the $1$-truncation, and of Eilenberg-Mac Lane spaces of the form $K(G,1)$ \cite{FinsterLicata}. Following \cite{FinsterLicata}, the Eilenberg Mac-Lane spaces $K(G,n)$ for $G$ abelian and $n\geq 2$ can be constructed once we have constructed the $k$-truncation for any $k\geq -2$. We note that Eilenberg-Mac Lane spaces are important classifying spaces in higher group theory, and so are the connected components of the universe (which we show to be essentially small). 

In \cref{chap:reflective} we consider general reflective subuniverses. Examples that we have at our disposal at this point are the $(-2)$-, $(-1)$-, $0$-, and $1$-truncations. Most examples of reflective subuniverses are obtained by localization at a family of maps. However, since the only assumed homotopy colimits are pushouts, we will construct localizations only in \cref{chap:compact}, and only of families between compact types, because we need more theory in order to establish the necessary basic results. Thus, in \cref{chap:reflective} we focus on general reflective subuniverses. We show that for any reflective subuniverse $L$, the subuniverse $L'$ of $L$-separated types (i.e.~types whose identity types are $L$-types) is again reflective. It follows at once that the subuniverse of $k$-truncated types is reflective, for any $k\geq -2$. Furthermore, we will study several classes of maps related to a reflective subuniverse. First of all, we study the $L$-equivalences, i.e.~the maps that become an equivalence by the functorial action of $L$, and second of all we study the $L$-connected maps, i.e.~ the maps with fibers that become trivial after applying $L$. Clearly, any $L$-connected map is also an $L$-equivalence, but the converse is one of the many characterizations of $L$ being lex. A final topic for this chapter is the notion of accessible reflective subuniverse. I began to study reflective subuniverses with Mike Shulman and Bas Spitters, see \cite{RijkeShulmanSpitters}, and continued to study them with my MRC teammates Morgan Opie and Luis Scoccola, under the lead of Dan Christensen. In particular, the result that the subuniverse of $L$-separated types is again a reflective subuniverse, and the results that follow from this, are joint work with my MRC group. 

In \cref{chap:modalities} we study modalities. One of the characterizations of modalities is as reflective subuniverses that are $\Sigma$-closed, but we provide three more equivalent definitions of modalities. One particularly important alternative definition is that of a stable orthogonal factorization system, i.e.~a pair $(\mathcal{L},\mathcal{R})$ of two classes of maps such that every map factors as an $\mathcal{L}$-map followed by a $\mathcal{R}$-map; the class $\mathcal{L}$ is left orthogonal to the class $\mathcal{R}$; and the pullback of an $\mathcal{L}$-map is again a $\mathcal{L}$-map. For any modality $\modal$, the stable orthogonal factorization system associated to it consists of the $\modal$-connected maps as the $\mathcal{L}$-maps, and the $\modal$-modal maps as the $\mathcal{R}$-maps. The next topic of this chapter is that of lex modalities. In \cref{thm:lex-modalities} we provide a long list of equivalent characterizations of lex modalities. The results of this chapter are joint work with Mike Shulman and Bas Spitters, and are a selection of the results in \cite{RijkeShulmanSpitters}. The selection has been made on the basis of how well the material fits in the narrative of this thesis and on compatibility with the overall assumptions, taking into consideration that both \cite{RijkeShulmanSpitters} and this thesis are quite long.\marginnote{Or is it better to include the entire \cite{RijkeShulmanSpitters}?}

In \cref{chap:equifibrant} we recall from \cite{WellenPhD} the notion of $\modal$-\'etale map for an arbitrary modality $\modal$. We prove a modal version of the descent theorem, which asserts that a maps into $\modal X$ from a $\modal$-modal type are equivalently described as \'etale maps into $X$. The $\modal$-\'etale maps form the right class of a second orthogonal factorization system associated to any modality: the \emph{reflective} factorization system. The left class of this factorization system is the class of $\modal$-equivalences. Using this factorization system we obtain that the universal cover of a type $X$ at a point $x_0$ is the left-right-factorization of the map $\unit\to X$. 
We then proceed to study the \'etale maps for the modality of discrete reflexive graphs. Note that the type of all reflexive graphs isn't exactly a universe, so it is not possible to directly apply our previous observations about $\modal$-\'etale maps. Nevertheless, most arguments are practically the same. Thus, we treat our section on $\modal$-\'etale maps as a blue-print for our section of $\Delta$-\'etale maps, and do most arguments a second time. Such is the current state of homotopy type theory. What we get out is a generalized flattening lemma, which states that for any morphism $f:\mathcal{B}\to\mathcal{A}$ factors uniquely as an $\Delta$-equivalence followed by a fibration of graphs. We use this to show that the loop space of the suspension of a pointed type $X$ is the free H-space $G$ with a base-point preserving map $X\to_\ast G$. In particular, the loop space of the $(n+1)$-sphere is the free H-space $G$ with a base-point preserving map $\sphere{n}\to_\ast G$. \marginnote{Check that this is in \cref{chap:equifibrant}}
The generalized flattening lemma also applies to diagrams over reflexive graphs, and in particular to sequential colimits. Moreover, the equifibrant replacement can be constructed by a telescope construction. We show in this chapter that sequential colimits commute with $\Sigma$- and identity types, and therefore also with pullbacks. In particular, the sequential colimit operation sends sequences of fiber sequences to fiber sequences. Moreover, we show that sequential colimits commute with $k$-truncation for all $k\geq -2$, from which it follows that sequential colimits commute with $\pi_k$ for any $k\geq 0$. We expect to be able to use these results also in showing that the spectrification of a pre-spectrum is indeed a spectrum, but we haven't done that yet.
The results on the equifibrant replacement operation are joint work with Bas Spitters, although these results only came together nicely after the modal descent property was established, which happened in discussions with Felix Wellen, from whom I learned about $\modal$-\'etale maps, and Mike Shulman, who alerted me to the reflective factorization system of a modality. The special case of equifibrant replacement for sequential colimits was obtained by separate methods in joint work with Floris van Doorn, who also formalized it in Lean, and Kristina Sojakova.

In \cref{chap:compact} we introduce the notion of (sequentially) compact types. The most important basic result about compact types is that they are closed under pushouts, and in proving this fact we use that sequential colimits commute with pullbacks.
Then, we finally get to construct a wide class of reflective subuniverses. For any family $f$ of maps between compact types, the subuniverse of $f$-local types is reflective. In principle, such a result should hold for $\kappa$-compact types for cardinals larger than $\omega$. However, we do not have a good theory of such larger cardinals available in homotopy type theory, while the natural numbers object is right there (by assumption). Nevertheless, the case of localization at maps between compact types already provides many examples of interest, since any sphere is compact. We note that in the construction of $f$-localization, and in the construction of the factorization system associated to it, we use the $2$-pushouts developed in \cref{chap:simplicial}.

In \cref{chap:higher_groups} we homotopy type theory to study higher group theory. Since types are thought of as $\infty$-groupoids, an \emph{$\infty$-group} is defined to be a pointed connected type, and an $(n+1)$-group is defined to be a pointed connected $(n+1)$-type. More generally, a $k$-tuply groupal $\infty$-group is defined to be a pointed $(k-1)$-connected type, and a $k$-tuply groupal $(n+1)$-group is defined to be a pointed $(k-1)$-connected $(n+k)$-type. Our first theorem asserts that the type of pointed maps between $k$-tuply groupal $(n+1)$-groups is $n$-truncated. In particular, it follows that the type of pointed maps between pointed connected $1$-types is a set. Indeed, it is equivalent to the set of group homomorphisms between their loop spaces: we show that the category of set-level groups (in the usual sense) is equivalent to the category of pointed connected $1$-types. 

Moreover, we show that for $k> n$, the type of $k$-tuply groupal $(n+1)$-groups is equivalent to the type of $(k+1)$-tuply groupal $(n+1)$-groups. In particular, the type of $2$-groupal $1$-groups, i.e.~the type of abelian groups, is equivalent to the type of $k$-tuply groupal $1$-groups for all $k>1$. This equivalence extends to an equivalence of categories: the category of abelian groups is equivalent to the category of pointed $n$-connected $(n+1)$-types, for each $n\geq 1$. Once $n$-categories are defined in homotopy type theory, for arbitrary $n$, it should be possible to show that the category of $n$-tuply groupal $(n+1)$-groups is equivalent to the type of $k$-tuply groupal $(n+1)$-groups, for all $k\geq n$. The contents of \cref{chap:higher_groups} are joint work with Ulrik Buchholtz and Floris van Doorn, and have been published in \cite{BuchholtzDoornRijke}.

In \cref{chap:projective} we construct the real and complex projective spaces in type theory. 
The contents of this chapter are joint work with Ulrik Buchholtz. \marginnote{Give proper intro to this chapter}

In \cref{chap:prime} we study localization at the degree $k$ maps on $\sphere{1}$. We show that for a simply connected type $X$, the degree-$k$-localization of $X$ is again a simply connected type, of which the homotopy groups are the algebraically localized homotopy groups. \marginnote{Give proper intro to this chapter}
The contents of this chapter are joint work with Dan Christensen, Morgan Opie, and Luis Scoccola.

In \cref{chap:giraud}
The contents of this chapter are joint work with Simon Boulier and Nicolas Tabareau. Many of the results of this chapter have already been formalized in Coq, although some of the formalization is still work in progress.

\section{Acknowledgments\footnote{I gratefully acknowledge the support of the Air Force Office of Scientific Research through MURI grant FA9550-15-1-0053.}}
First and foremost, it is my pleasure to thank my advisor, professor Steve Awodey. I could not have done this PhD without his advice, support, and inspiration. I cherish the many pleasant discussions we had: over the blackboard, between us, with our many visitors, while visiting other places, or over a beer somewhere in Pittsburgh. I am very grateful for the guidance you offered in selecting a worthwhile research topic, and I feel honored to have had the privilege to work with you.

Then I would like to express my gratitude to the members of my committee: Jeremy Avigad for transmitting his enthusiasm for interactive theorem proving, and for his wisdom and unparalleled kindness; Ulrik Buchholz for his unabated energy to make large formalization projects possible, introducing me to many concepts of algebraic topology along the way; and Michael Shulman for shining a light on many beautiful subjects related to higher category theory, that would otherwise have remained obscure for me.

I would like to thank my other collaborators, the people I had projects with:
Simon Boulier, Dan Christensen, Floris van Doorn, Jonas Frey, Morgan Opie, Luis Scoccola, Kristina Sojakova, Bas Spitters, Nicolas Tabareau, Felix Wellen, and Alexandra Yarosh. I thank you for all your inspiration, insights, energy, and creativity.

I would also like to thank all the people who have generously invited me for a visit. I am deeply indebted to Joachim Kock, who has hosted me for half a year in 2013-2014 at the \textit{Departament de Matemàtiques} of the Universitat Autònoma de Barcelona and helped me finding my PhD position at CMU; I am grateful to Vladimir Voevodsky for inviting me to the Institute for Advanced Study in March 2015; Nicolas Tabareau and his students Kevin Quirin and Simon Boulier for hosting me at INRIA Nantes during the summers of 2015 and 2016; Andrej Bauer for hosting me at the \textit{Fakulteta za Matematiko in Fiziko} of the University of Ljubljana in January 2016; Lars Birkedal and Bas Spitters for hosting me at the Department of Computer Science of Aarhus University in February 2016; Marie-Françoise Roy for inviting me to speak in the Effective Geometry and Algebra seminar at the \textit{Institut de Recherche Mathématiques de Rennes} in June 2016; Dan Christensen and his student Luis Scoccola for hosting me at the University of Western Ontario in London, Ontario in October 2017; Guillaume Brunerie for hosting me at the Institute for Advanced Study in November 2017; Charles Rezk and his student Nima Rasekh for inviting me to speak in the Topology Seminar at the University of Illinois at Urbana-Champaign in December 2017; Tom Hales for inviting me to speak at the Algebra, Combinatorics, and Geometry seminar at the University of Pittsburgh in April 2018; and Pieter Hofstra for inviting me to speak for the Canadian Mathematical Society in Fredericton, New Brunswick, in June 2018. Tak, dankjewel, thank you, merci, danke sch\"on, spasibo, \v dankujem, hvala, gracias.

%\marginnote{It is probably a bad idea to try to thank everyone that I discussed with, isn't it?}
%Furthermore, I have had the pleasure to discuss mathematics with many more researchers, either at CMU, visiting CMU or while I was traveling. I thank Peter Aczel, Benedikt Ahrens, Thorsten Altenkirch, Matthieu Anel, Carlo Angiuli, Marc Bezem, Matthew Bowen, Fortune Buchholtz, Evan Cavallo, Mario Carneiro, Eugenia Cheng, Thierry Coquand, Peter Dybjer, Mart\'in Escard\'o, Favonia, Eric Finster, Marcelo Fiore, Henrik Forsell, Nicola Gambino, Richard Garner, Gaetan Gilbert, Clark Glymour, Robert Graham, Daniel Grayson, Chris Grossack, Robert Harper, Johannes H\"olzl, Simon Huber, Martin Hyland, Pieter Hofstra, André Joyal, Chris Kapulkin, Cory Knapp, Nicolai Kraus, Greg Langmead, Marco Larrea, Peter LeFanu Lumsdaine, Rob Lewis, Dan Licata, Milly Maietti, Per Martin-L\"of, Adam Millar, Ed Morehouse, Anders Mörtberg, Jacob Neumann, Max New, Clive Newstead, Tristan Nguyen, Paige North, Ian Orton, Fabio Pasquali, Jennifer Paykin, Pierre-Marie Pédrot, Frank Pfenning, Andrew Pitts, Dorette Pronk, Kevin Quirin, Jakob von Raumer, Emily Riehl, Zesen Qian, Christian Sattler, Dana Scott, Peter Selinger, Alex Simpson, Sam Speight, Raffael Stenzel, Jon Sterling, Thomas Streicher, Matthieu Sozeau, Amelia Tebbe, Laurent Théry, Andrew Warren, Michael Warren, Kevin Zhou, and Colin Zwanziger for all your valuable insights.

I would like to thank Karin Arnds for lending me her cabin along the Allegheny River, where I wrote and rewrote significant parts of this dissertation.

Finally, I thank my dear parents Mieke and Reinier for their unconditional support, and my siblings Jeroen, Sophie, and Fleur, whom I didn't get to see as much as I would have liked because I chose to study overseas. I miss you and I dedicate this thesis to you.\\[2em]


\noindent \hfill Pittsburgh, \today
